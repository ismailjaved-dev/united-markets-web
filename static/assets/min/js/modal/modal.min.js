const activeClass="active",pwdErrorName="auth-error-pwd",emailErrorName="auth-error-email",errorName="auth-error",emailPrefixId="auth-email",pwdPrefixId="auth-password",currenciesPerCountry={NO:"NOK",SE:"SEK",GB:"GBP"};function submitForm(e,t){e.preventDefault();const n=t===modals.signup||t===modals.banner||t===modals.banner2,o=document.getElementById(`${emailPrefixId}-${t}`),s=document.getElementById(`${pwdPrefixId}-${t}`);formatErrors();const i=validateEmail(t),a=validatePwd(t);if(i||a)return;const r=getContext(document.cookie.match(new RegExp("(^| )utm=([^;]+)")),n),d=document.getElementById(`auth-submit-cta-${t}`),l=document.getElementById(`auth-submit-${t}`);displayLoader(!0,l,d);const[c,m]=getParamsArray(),u=getLanguageIso(m);let w={[n?"email":"principal"]:o.value,password:s.value,sessionContext:r};axios.all([axios.get("/country-code"),axios.get("/g/countries")]).then(axios.spread(function(e,t){const o=e.headers["x-country-code"]||"",s=(t.data||[]).find(e=>e.iso2Name.toLowerCase()===o.toLowerCase())||{},i=n?"/g/v3/customers":"/g/auth/v1/sessions";return w=Object.assign(w,n?{languageIso:u,legalEntity:"row"===c?"SEYCHELLES":"CYSEC",inferredCountryOfResidenceIso:s.iso2Name}:{}),fetch(i,{method:"POST",mode:"cors",body:JSON.stringify(w),headers:n?{"Content-Type":"application/json","x-source_caller":"frontend-service","x-function":window.location.pathname}:{}})})).then(e=>e.ok?e.json():Promise.reject(e.status)).then(e=>{setupCookies(e,t,m),t===modals.banner&&trackClick();const o=isViewSmallerThan(850);go(n?"lead":o?"watchlist":"trading")}).catch(e=>{displayLoader(!1,l,d),Number.isInteger(e)?displayElement(422===e?`repeated-email-${t}`:`${401===e?"unauthorised":"error"}-${t}`):displayElement(`generic-${t}`)})}function validatePwd(e){formatErrors([pwdErrorName]);const t=document.getElementById(`${pwdPrefixId}-${e}`),n=t.value,o="format-password";return t.validity.valid&&n.trim().length?(e===modals.signup||e===modals.banner||e===modals.banner2)&&(!n||n.length<8?displayElement(`${o}-${e}-one`):/\d/.test(n)?/[A-Z]/.test(n)?/[a-z]/.test(n)?/^([A-ZÅÄÖa-zåäö0-9 !\"#$%&'()*+,\-./\\:;<=>?@[\]^_`{|}~])*$/.test(n)?void 0:displayElement(`${o}-${e}-five`):displayElement(`${o}-${e}-four`):displayElement(`${o}-${e}-three`):displayElement(`${o}-${e}-two`)):displayElement(`required-password-${e}`)}function getLanguageIso(e){return{cn:"zh-Hans",zh:"zh-Hant"}[e]||e}function validateEmail(e){formatErrors([emailErrorName]);const t=document.getElementById(`${emailPrefixId}-${e}`),n=document.getElementById(`auth-submit-email-${e}`);n&&(n.disabled=!0);const o=t.value.match(/\ *[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]+\ */);return t.validity.valueMissing?displayElement(`required-email-${e}`):t.validity.valid&&!t.validity.typeMismatch&&o&&o[0]===t.value?void(n&&(n.disabled=!1)):displayElement(`invalid-email-${e}`)}function setupCookies(e,t,n){const o=jwt_decode(e.accessToken),s=" expires="+new Date(Date.now()+2e4).toISOString()+"; path=/";document.cookie="auth_exp="+o.exp+";"+s,document.cookie="cid="+e.customerId+";"+s,document.cookie="auth_action="+t+";"+s,document.cookie="auth_language="+n+";"+s}function displayElement(e){return document.getElementById(e).classList.add(activeClass),!0}function displayLoader(e,t,n){t.classList[e?"add":"remove"]("loading"),n.style.display=e?"none":"inline-block"}function formatErrors(e){const t=e||[emailErrorName,pwdErrorName,errorName];for(let e=0;e<t.length;e++){const n=document.getElementsByName(t[e]);for(let e=0,t=n.length;e<t;e++)n[e].classList.remove(activeClass)}}function getContext(e,t){let n;const o=this.getDeviceInfo();let s={channel:o.mobile?o.os.toLowerCase()+"-web":"web"};return e&&t&&(n=JSON.parse(e[2]),Object.keys(n).forEach(e=>{const t=`tracking${e.charAt(0).toUpperCase()+e.slice(1)}`;s=Object.assign(s,{[t]:n[e]})})),s}function isViewSmallerThan(e){return(document.body.getBoundingClientRect().width||document.body.clientWidth)<=e}function getDeviceInfo(){let e;const t=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(navigator.appVersion),n=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(let t in n){let o=n[t];if(o.r.test(navigator.userAgent)){e=o.s;break}}return/Windows/.test(e)&&(e="Windows"),{mobile:t,os:e}}formatErrors();